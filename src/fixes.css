/**
 * effective-css-reset – Fixes Layer
 * @layer fixes
 *
 * Goal: Browser-specific workarounds and bug fixes; no visual design decisions.
 * UFX-001 to UFX-022
 */

@layer fixes {
  /**
   * UFX-010, UFX-011: Prevent font-size inflation on mobile browsers.
   *
   * Affected browsers: Mobile Safari, some Android browsers
   * Description: When a page has a viewport meta tag but contains text in a
   * container narrower than the viewport, mobile browsers may inflate the
   * font-size to make it more readable. This causes inconsistent text sizing.
   *
   * References:
   * - https://developer.mozilla.org/en-US/docs/Web/CSS/text-size-adjust
   * - https://kilianvalkhof.com/2022/css-html/your-css-reset-needs-text-size-adjust-probably/
   * - https://webkit.org/blog/57/css3-text-size-adjust/
   *
   * Vendor prefixes:
   * - -moz-: Firefox on Android (not desktop)
   * - -webkit-: Safari (iOS/macOS), Chrome, Edge
   *
   * Aligned with:
   * - Normalize.css – html { -webkit-text-size-adjust: 100% }
   * - Modern Normalize (Sindre Sorhus) – text-size-adjust: 100%
   * - Kilian Valkhof – explicit recommendation including -moz- prefix
   */
  html {
    -moz-text-size-adjust: 100%;
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;

    /**
     * Normalize tab character width in <pre> elements.
     * Browsers default to 8 spaces which is excessively wide.
     *
     * References:
     * - https://developer.mozilla.org/en-US/docs/Web/CSS/tab-size
     *
     * Aligned with:
     * - Normalize.css – html { tab-size: 4 }
     * - Modern Normalize (Sindre Sorhus) – tab-size: 4
     * - Tailwind Preflight – tab-size: 4
     * (We use 2 for more compact code display)
     */
    -moz-tab-size: 2;
    tab-size: 2;

    /**
     * UFX-030: Enable automatic color scheme adaptation.
     *
     * Allows the browser to automatically adjust native UI elements
     * (scrollbars, form controls, selection colors) based on the user's
     * preferred color scheme (light/dark mode).
     *
     * References:
     * - https://developer.mozilla.org/en-US/docs/Web/CSS/color-scheme
     * - https://web.dev/color-scheme/
     *
     * Aligned with:
     * - Pawel Grzybek – html { color-scheme: light dark }
     * - Keith J. Grant – color-scheme recommendation
     * - Modern Normalize (Sindre Sorhus) – supports color-scheme
     */
    color-scheme: light dark;
  }

  /**
   * UFX-040, UFX-041: Improve font rendering on macOS/WebKit browsers.
   *
   * -webkit-font-smoothing: antialiased renders fonts with grayscale antialiasing
   * instead of subpixel antialiasing. This produces thinner, crisper text that
   * many designers prefer, especially on high-DPI displays.
   *
   * Note: This is WebKit-specific and has no effect on Firefox or other browsers.
   * Firefox uses its own font rendering which is generally already well-tuned.
   *
   * References:
   * - https://developer.mozilla.org/en-US/docs/Web/CSS/font-smooth
   * - https://usabilitypost.com/2012/11/05/stop-fixing-font-smoothing/
   *
   * Aligned with:
   * - Josh Comeau – body { -webkit-font-smoothing: antialiased }
   * - Pawel Grzybek – -webkit-font-smoothing: antialiased
   * - Tailwind Preflight – -webkit-font-smoothing: antialiased
   *
   * Controversy: Some argue subpixel rendering is more readable on low-DPI screens.
   * Modern high-DPI displays benefit from antialiased rendering.
   */
  body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /**
   * UFX-020, UFX-021: Respect user preference for reduced motion.
   *
   * Affected browsers: All browsers that support prefers-reduced-motion
   * Description: Users with vestibular motion disorders or motion sensitivity
   * can indicate they prefer reduced motion. This ensures smooth scrolling
   * is disabled for these users.
   *
   * References:
   * - https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-reduced-motion
   * - https://www.smashingmagazine.com/2021/10/respecting-users-motion-preferences/
   * - https://web.dev/prefers-reduced-motion/
   *
   * Aligned with:
   * - Josh Comeau – @media (prefers-reduced-motion: reduce) handling
   * - Andy Bell (Piccalilli) – more aggressive (animation/transition-duration: 0.01ms)
   * - Jake Lazaroff – scroll-behavior: auto
   *
   * UFX-022: Additional reductions (animation-duration, transition-duration)
   * are intentionally omitted in v1 to avoid breaking intentional animations.
   * Implementers should handle these in their own stylesheets as needed.
   */
  @media (prefers-reduced-motion: reduce) {
    * {
      scroll-behavior: auto !important;
    }
  }

  /**
   * UFX-050: Ensure the hidden attribute works even when display is overridden.
   *
   * The HTML `hidden` attribute should hide elements, but CSS rules that set
   * `display` can accidentally override it. Using `!important` ensures the
   * attribute always works as intended.
   *
   * References:
   * - https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/hidden
   * - https://www.scottohara.me/blog/2023/03/21/visually-hidden-content.html
   *
   * Aligned with:
   * - Andy Bell (Piccalilli) – [hidden] { display: none !important }
   * - CSS Remedy (Jen Simmons) – [hidden] { display: none }
   * - The New CSS Reset (Elad Shechter) – :where([hidden]) { display: none }
   * - Normalize.css – [hidden] { display: none }
   */
  [hidden] {
    display: none !important;
  }
}
